# OpenVas Vulnerability-Scanning
Openvas Scan done with and without credentials.


## Introduction

In this project, I am doing a full vulnerability lab in the cloud.  I am creating a vulneraability management Linux server leveraging OpenVas, and using that server to scan a windows 10 VM I deployed in Azure. The VM will be made vulnerable via the installation of old software and the disablement of host based security controls. The old software has known vulnerabilities and will ensure positive results for our scan. In this lab I will visually demonstrate the difference between an unauthenticated scan vs a credentialed scan. I will also demonstrate remediation by reducing the the amount of vulnerabilities on my Windows 10 VM. VM 

## Installation of OpenVas Image in Azure.
I chose the basic DEv/Test image because it was more than enough to accomplish the simulation. I then followed up with proper settings for deployment in Azure.
![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/7aa070a4-43b9-4fb7-bb1b-9310fcf8b88a)
![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/cfa3cdca-b8f5-4e6e-a534-7348c1d822bb)
![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/42c0db37-ba40-44a6-b917-a5a0eb90bfe7)

## SSH Into the OpenVas Machine.
After successful deployment of the OpenVas server the next step was to SSH into it using terminal and allow time for full setup. 

![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/a6399036-1863-44a8-9451-465ea0a3be79)






After a few minutes we can log into our OpenVas instance.





![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/e03cd9e6-0441-45d2-af83-a4f6f45d2942)




## Deploying A Windows 10 VM.
During this phase I am deploying A windows VM which will serve as the machine that we will make vulnerable for the non-authenticated scans as well as the credentialed scan.  we will depricate the VM by adding old software, and disabling host based controls. 


![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/748e378b-d3a7-490b-83c9-4de1f62a7dab)



## RDP Into the Windows 10 VM.

Next I used RDP to remote in to the VM to start disabling the host based security as well as install the old software.









![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/78cf72ea-dbd7-44b5-8be6-33c2d1df1f1c)




![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/40d034ed-bbd5-4ca3-ad5b-9ef803e7864f)





![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/bd6a7e8b-d86f-408a-b104-e4860b9567dd)





![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/28e1276f-1464-4bef-a585-6ca1fbb932fc)






## Configure OpenVas For Unathenticated Scan.

After installing old software as well as disabling host based security controls I proceeded to gather the private IP for the windows VM to configure OpenVas for an unauthenticated scan. Once the private IP is entered I created new targets and tasks to scan the now vulnerable VM.



![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/b523ba0f-bad9-4b65-a9e4-73b60f7ed937)








![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/62522236-06eb-4852-b839-a011c4ace2a2)








![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/154c3578-2a02-4e75-893f-16d2aaad8cbe)






## Preliminary scan results.

The unauthenticated scan only produced reports of medium severity. Upon drilling down into the results, many of the highlighted vulnerabilities were only a 2.6 in severity. This is due to not having credentials to the system.




![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/c318c910-fbc9-42ec-8f0c-aab9201c38fb)


 




## Preparing for Credentialed Scanning

In this phase I go back to the windows VM to prep it for credentialed scanning. First I disabled user account control settings, enabled remote registry,and changed settings in registry edit to allow scans without administrator account.





![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/f7e99194-0d45-4864-b3f6-577881b4e8cd)













![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/75abdbba-6e5a-432c-99ad-0cc97ed27533)















![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/6730d33e-e14a-4bc5-a847-c15b5b18f077)











## Credentialed Scanning in OpenVas




Next I setup New credentials,target,and task. to configue OpenVas to scan again. This time with access to the internal system.  








![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/e6d3d14a-4320-4927-816f-da78f0134326)












![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/22e4ebdd-d4c2-4e7b-8553-313cb4a681db)












![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/f77fcf37-2897-4ed2-8a52-a0ae386c0f65)








## Credentialed Scan Results


The results of this scan as displayed by the dashboard and data charts were much more severe. There is a noticable hike in severity when compared to the unauthenticated scans,and as we drill into the vulnerability reports, we can see that the the major vulnerabilities were the older software I installed on the instance. This underlines just how critical  that software patching is to reducing attach surface and maintaining an infastructure with lower risk. A deeper dive into an individual vulnerability OpenVas informs us on detection results, how the vulneralbilities can be exploited, the detection methods, and what software needs attention. In addition to that it also tells us what impact this could we have if we dont renediate as well as solutions to remediate these vulneralbilities.     



![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/fab34cc9-ee40-4c1b-a76c-d4bf3d6867b3)









![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/d02ca19a-3ba1-441f-a6b7-3933cf929474)











![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/56327a40-5d3e-439f-a155-e39d16e123e6)











## Methods for Remediation 


In order to adress the vulnerability risks, I had an option to update the software to the recommended versions, but I decided to remove the software all together. I also discovered that the VM itself needed updates.  I did the necessary updates as well as uninstalled the older software and we can see from the second credentialed scan that although high, our vulnerabilities have already seen a noticable declince in vulneravbilities. Some of the vulnerabilities are due to disabled hostbased controls. Utilizing OpenVas we can continue using the scan results to identify and remediate our vulnerabilities untilwe can reach an acceptable level.   





![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/fe0d6d91-f0de-47ea-8fed-e4d889ba344f)










![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/5e2ab596-f64e-48f5-b0c3-316ff1a5f857)









![Architecture Diagram](https://github.com/Knighthawk76/Vulnerability-Scanning/assets/152114740/82846212-ea58-4955-b8a9-a4884c2e4df6)








## Conclusion

In this project, I learned how to use OpenVas as well as run credentialed and unauthenticated scans.  I was able to see results of these scans as well as understand the impacts of these vulnerabilities as well as how they can be manipulated. The project reinforced just how critical patching and updating software is, and how expensive it could be to deal with an incident due to not being thorough in reducing an organizations attack surface.  I also learned the importance of CVEs (Common Vulnerability Exposures) and how important it is to continuously scan for vulnerabilities as well as remediate.  
